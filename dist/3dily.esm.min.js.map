{"version":3,"file":"3dily.esm.min.js","sources":["../build/esm/Controller.js","../build/esm/Scene.js","../build/esm/index.js"],"sourcesContent":["var Controller = /** @class */ (function () {\n    function Controller(element, framesCount, onChangeFrame) {\n        this.pointerPosition = { x: 0, y: 0 };\n        this.pointerIsDown = false;\n        this.moved = false;\n        this.activeIndex = 0;\n        this.element = element;\n        this.framesCount = framesCount;\n        this.onChangeFrame = onChangeFrame;\n        this.init();\n    }\n    Controller.prototype.init = function () {\n        var _this = this;\n        this.element.onpointerdown = function (e) {\n            _this.pointerPosition = { x: e.clientX, y: e.clientY };\n            _this.pointerIsDown = true;\n        };\n        this.element.onpointermove = function (e) {\n            if (!_this.pointerIsDown /* || zoomIsEnable */)\n                return;\n            var deltaX = _this.pointerPosition.x - e.clientX;\n            if (Math.abs(deltaX) < 3)\n                return;\n            var index = deltaX < 0 ? _this.activeIndex - 1 : _this.activeIndex + 1;\n            _this.activeIndex =\n                index > _this.framesCount - 1\n                    ? 0\n                    : index < 0\n                        ? _this.framesCount - 1\n                        : index;\n            _this.onChangeFrame(_this.activeIndex);\n            _this.pointerPosition = { x: e.clientX, y: e.clientY };\n        };\n        this.element.onpointerup = function () {\n            _this.pointerIsDown = false;\n        };\n    };\n    return Controller;\n}());\nexport { Controller };\n","import { Controller } from './Controller.js';\nvar API_URL = 'https://dev.api.3dily.com/scene/';\nvar Scene = /** @class */ (function () {\n    function Scene(opts) {\n        var _this = this;\n        this.framesCount = 0;\n        this.activeFrame = 0;\n        this.frameElements = [];\n        this.onChangeFrame = function (i) {\n            _this.frameElements[_this.activeFrame].classList.remove('_3dily-frame-active');\n            _this.frameElements[i].classList.add('_3dily-frame-active');\n            _this.activeFrame = i;\n        };\n        this.opts = opts;\n        this.init();\n    }\n    Scene.prototype.init = function () {\n        this.container = document.getElementById(this.opts.containerId);\n        if (!this.container) {\n            console.error('Container not found');\n            return;\n        }\n        this.wrapper = document.createElement('div');\n        this.wrapper.classList.add('_3dily-scene');\n        this.container.appendChild(this.wrapper);\n        this.baseUrl = API_URL + this.opts.panelId + '/' + this.opts.productCode;\n        this.setupScene();\n    };\n    Scene.prototype.setupScene = function () {\n        var _this = this;\n        fetch(\"\".concat(this.baseUrl, \"/data\"))\n            .then(function (res) { return res.json(); })\n            .then(function (data) {\n            _this.framesCount = data.files[0].frames.length;\n            _this.controller = new Controller(_this.wrapper, _this.framesCount, _this.onChangeFrame);\n            for (var i = 0; i < _this.framesCount; i++) {\n                var img = document.createElement('img');\n                img.classList.add('_3dily-frame');\n                i === _this.activeFrame && img.classList.add('_3dily-frame-active');\n                img.src = \"\".concat(_this.baseUrl, \"/image?shadow=true&frame=\").concat(i, \"&quality=2k\");\n                _this.wrapper.appendChild(img);\n                _this.frameElements.push(img);\n            }\n        });\n    };\n    return Scene;\n}());\nexport { Scene };\n","import { Scene as _Scene } from './Scene.js';\nfunction Scene(opts) {\n    var Scene = new _Scene(opts);\n    return Scene;\n}\nexport { Scene };\n"],"names":["Controller","element","framesCount","onChangeFrame","this","pointerPosition","x","y","pointerIsDown","moved","activeIndex","init","prototype","_this","onpointerdown","e","clientX","clientY","onpointermove","deltaX","Math","abs","index","onpointerup","Scene","opts","activeFrame","frameElements","i","classList","remove","add","container","document","getElementById","containerId","wrapper","createElement","appendChild","baseUrl","panelId","productCode","setupScene","console","error","fetch","concat","then","res","json","data","files","frames","length","controller","img","src","push","_Scene"],"mappings":";;;;AAAA,IAAIA,EAA4B,WAC5B,SAASA,EAAWC,EAASC,EAAaC,GACtCC,KAAKC,gBAAkB,CAAEC,EAAG,EAAGC,EAAG,GAClCH,KAAKI,eAAgB,EACrBJ,KAAKK,OAAQ,EACbL,KAAKM,YAAc,EACnBN,KAAKH,QAAUA,EACfG,KAAKF,YAAcA,EACnBE,KAAKD,cAAgBA,EACrBC,KAAKO,OA4BT,OA1BAX,EAAWY,UAAUD,KAAO,WACxB,IAAIE,EAAQT,KACZA,KAAKH,QAAQa,cAAgB,SAAUC,GACnCF,EAAMR,gBAAkB,CAAEC,EAAGS,EAAEC,QAAST,EAAGQ,EAAEE,SAC7CJ,EAAML,eAAgB,GAE1BJ,KAAKH,QAAQiB,cAAgB,SAAUH,GACnC,GAAKF,EAAML,cAAX,CAEA,IAAIW,EAASN,EAAMR,gBAAgBC,EAAIS,EAAEC,QACzC,KAAII,KAAKC,IAAIF,GAAU,GAAvB,CAEA,IAAIG,EAAQH,EAAS,EAAIN,EAAMH,YAAc,EAAIG,EAAMH,YAAc,EACrEG,EAAMH,YACFY,EAAQT,EAAMX,YAAc,EACtB,EACAoB,EAAQ,EACJT,EAAMX,YAAc,EACpBoB,EACdT,EAAMV,cAAcU,EAAMH,aAC1BG,EAAMR,gBAAkB,CAAEC,EAAGS,EAAEC,QAAST,EAAGQ,EAAEE,YAEjDb,KAAKH,QAAQsB,YAAc,WACvBV,EAAML,eAAgB,IAGvBR,KCnCPwB,EAAuB,WACvB,SAASA,EAAMC,GACX,IAAIZ,EAAQT,KACZA,KAAKF,YAAc,EACnBE,KAAKsB,YAAc,EACnBtB,KAAKuB,cAAgB,GACrBvB,KAAKD,cAAgB,SAAUyB,GAC3Bf,EAAMc,cAAcd,EAAMa,aAAaG,UAAUC,OAAO,uBACxDjB,EAAMc,cAAcC,GAAGC,UAAUE,IAAI,uBACrClB,EAAMa,YAAcE,GAExBxB,KAAKqB,KAAOA,EACZrB,KAAKO,OA+BT,OA7BAa,EAAMZ,UAAUD,KAAO,WACnBP,KAAK4B,UAAYC,SAASC,eAAe9B,KAAKqB,KAAKU,aAC9C/B,KAAK4B,WAIV5B,KAAKgC,QAAUH,SAASI,cAAc,OACtCjC,KAAKgC,QAAQP,UAAUE,IAAI,gBAC3B3B,KAAK4B,UAAUM,YAAYlC,KAAKgC,SAChChC,KAAKmC,QAxBC,mCAwBmBnC,KAAKqB,KAAKe,QAAU,IAAMpC,KAAKqB,KAAKgB,YAC7DrC,KAAKsC,cAPDC,QAAQC,MAAM,wBAStBpB,EAAMZ,UAAU8B,WAAa,WACzB,IAAI7B,EAAQT,KACZyC,MAAM,GAAGC,OAAO1C,KAAKmC,QAAS,UACzBQ,MAAK,SAAUC,GAAO,OAAOA,EAAIC,UACjCF,MAAK,SAAUG,GAChBrC,EAAMX,YAAcgD,EAAKC,MAAM,GAAGC,OAAOC,OACzCxC,EAAMyC,WAAa,IAAItD,EAAWa,EAAMuB,QAASvB,EAAMX,YAAaW,EAAMV,eAC1E,IAAK,IAAIyB,EAAI,EAAGA,EAAIf,EAAMX,YAAa0B,IAAK,CACxC,IAAI2B,EAAMtB,SAASI,cAAc,OACjCkB,EAAI1B,UAAUE,IAAI,gBAClBH,IAAMf,EAAMa,aAAe6B,EAAI1B,UAAUE,IAAI,uBAC7CwB,EAAIC,IAAM,GAAGV,OAAOjC,EAAM0B,QAAS,6BAA6BO,OAAOlB,EAAG,eAC1Ef,EAAMuB,QAAQE,YAAYiB,GAC1B1C,EAAMc,cAAc8B,KAAKF,QAI9B/B,KC5CX,SAASA,EAAMC,GAEX,OADY,IAAIiC,EAAOjC"}