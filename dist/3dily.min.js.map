{"version":3,"file":"3dily.min.js","sources":["../build/esm/constants.js","../build/esm/scene/Controller.js","../build/esm/scene/Events.js","../build/esm/scene/index.js","../build/esm/index.js"],"sourcesContent":["export var API_URL = 'https://dev.api.3dily.com/scene/';\n","var clamp = function (number, min, max) {\n    return Math.min(Math.max(number, min), max);\n};\nvar Controller = /** @class */ (function () {\n    function Controller(element, framesCount, onChangeFrame, onZoom) {\n        this.pointerPosition = { x: 0, y: 0 };\n        this.pointerIsDown = false;\n        this.moved = false;\n        this.activeIndex = 0;\n        this.zoomIsEnable = false;\n        this.zoomScale = 4.3;\n        this.translate = { x: 0, y: 0 };\n        this.element = element;\n        this.framesCount = framesCount;\n        this.onChangeFrame = onChangeFrame;\n        this.onZoom = onZoom;\n        this.init();\n    }\n    Controller.prototype.init = function () {\n        var _this = this;\n        this.element.onpointerdown = function (e) {\n            _this.pointerPosition = { x: e.clientX, y: e.clientY };\n            _this.pointerIsDown = true;\n            _this.moved = false;\n        };\n        this.element.onpointermove = function (e) {\n            if (!_this.pointerIsDown || _this.zoomIsEnable)\n                return;\n            var deltaX = _this.pointerPosition.x - e.clientX;\n            if (Math.abs(deltaX) < 3)\n                return;\n            var index = deltaX < 0 ? _this.activeIndex - 1 : _this.activeIndex + 1;\n            _this.activeIndex =\n                index > _this.framesCount - 1\n                    ? 0\n                    : index < 0\n                        ? _this.framesCount - 1\n                        : index;\n            _this.moved = true;\n            _this.onChangeFrame(_this.activeIndex);\n            _this.pointerPosition = { x: e.clientX, y: e.clientY };\n        };\n        this.element.onclick = function (e) {\n            if (!_this.moved && !_this.zoomIsEnable) {\n                _this.zoomIsEnable = true;\n                _this.translate = _this.getTranslate(e.clientX, e.clientY);\n                _this.onZoom(\"scale(\".concat(_this.zoomScale, \") translate(\").concat(_this.translate.x, \"px, \").concat(_this.translate.y, \"px)\"));\n            }\n            else if (_this.zoomIsEnable) {\n                _this.zoomIsEnable = false;\n                _this.onZoom('unset');\n            }\n        };\n        this.element.onpointerup = function () {\n            _this.pointerIsDown = false;\n        };\n        this.element.onmousemove = function (e) {\n            if (!_this.zoomIsEnable)\n                return;\n            var translate = _this.getTranslate(e.clientX, e.clientY);\n            _this.onZoom(\"scale(\".concat(_this.zoomScale, \") translate(\").concat(translate.x, \"px, \").concat(translate.y, \"px)\"));\n        };\n        this.element.ontouchmove = function (e) {\n            if (!_this.zoomIsEnable)\n                return;\n            var widthDelta = (_this.element.clientWidth * (_this.zoomScale - 1)) / (2 * _this.zoomScale);\n            var heightDelta = (_this.element.clientHeight * (_this.zoomScale - 1)) /\n                (2 * _this.zoomScale);\n            var delta = {\n                x: e.touches[0].clientX - _this.pointerPosition.x,\n                y: e.touches[0].clientY - _this.pointerPosition.y,\n            };\n            _this.pointerPosition = {\n                x: e.touches[0].clientX,\n                y: e.touches[0].clientY,\n            };\n            _this.translate = {\n                x: clamp(_this.translate.x + delta.x * 0.4, -widthDelta, widthDelta),\n                y: clamp(_this.translate.y + delta.y * 0.4, -heightDelta, heightDelta),\n            };\n            _this.onZoom(\"scale(\".concat(_this.zoomScale, \") translate(\").concat(_this.translate.x, \"px, \").concat(_this.translate.y, \"px)\"));\n        };\n    };\n    Controller.prototype.getTranslate = function (clientX, clientY) {\n        var localPosition = {\n            x: clamp(clientX -\n                this.element.offsetLeft -\n                parseInt(window.getComputedStyle(this.element).borderWidth.replace('px', '')), 0, this.element.clientWidth),\n            y: clamp(clientY -\n                this.element.offsetTop -\n                parseInt(window.getComputedStyle(this.element).borderWidth.replace('px', '')), 0, this.element.clientHeight),\n        };\n        var widthDelta = (this.element.clientWidth * (this.zoomScale - 1)) / (2 * this.zoomScale);\n        var heightDelta = (this.element.clientHeight * (this.zoomScale - 1)) / (2 * this.zoomScale);\n        return {\n            x: widthDelta * (1 - (2 * localPosition.x) / this.element.clientWidth),\n            y: heightDelta * (1 - (2 * localPosition.y) / this.element.clientHeight),\n        };\n    };\n    return Controller;\n}());\nexport { Controller };\n","var Events = /** @class */ (function () {\n    function Events() {\n        this.handlers = {};\n    }\n    Events.prototype.on = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (!this.handlers[args[0]])\n            this.handlers[args[0]] = [];\n        this.handlers[args[0]].push(args[1]);\n    };\n    Events.prototype.trigger = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (!this.handlers[args[0]])\n            this.handlers[args[0]] = [];\n        for (var _a = 0, _b = this.handlers[args[0]]; _a < _b.length; _a++) {\n            var h = _b[_a];\n            h(args[1]);\n        }\n    };\n    Events.prototype.off = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (!this.handlers[args[0]])\n            this.handlers[args[0]] = [];\n        if (args[1]) {\n            this.handlers[args[0]] = this.handlers[args[0]].filter(function (h) { return h !== args[1]; });\n        }\n        else {\n            this.handlers[args[0]] = [];\n        }\n    };\n    return Events;\n}());\nexport { Events };\n","import { API_URL } from '../constants.js';\nimport { Controller } from './Controller.js';\nimport { Events } from './Events.js';\nvar Scene = /** @class */ (function () {\n    function Scene(opts) {\n        var _this = this;\n        this.activeFrame = 0;\n        this.frameElements = [];\n        this.loading = 0;\n        this.events = new Events();\n        this.zoom = false;\n        this.onChangeFrame = function (i) {\n            _this.frameElements[_this.activeFrame].classList.remove('threedily-frame-active');\n            _this.frameElements[i].classList.add('threedily-frame-active');\n            _this.activeFrame = i;\n        };\n        this.onZoom = function (transform) {\n            _this.frameElements[_this.activeFrame].style.transform = transform;\n            if (transform === 'unset') {\n                _this.zoom = false;\n                _this.frameElements[_this.activeFrame].src = _this.buildURL(_this.activeFrame);\n            }\n            else if (!_this.zoom) {\n                _this.zoom = true;\n                _this.frameElements[_this.activeFrame].src = _this.buildURL(_this.activeFrame, '4k');\n            }\n        };\n        this.onLoading = function (loading) {\n            if (loading === void 0) { loading = _this.loading + 1; }\n            _this.loading = loading;\n            if (_this.loading === _this.data.framesCount) {\n                _this.controller = new Controller(_this.sceneElement, _this.data.framesCount, _this.onChangeFrame, _this.onZoom);\n                setTimeout(function () {\n                    _this.progressbar.remove();\n                }, 1200);\n            }\n            ;\n            _this.progressbar.firstChild.style.width = \"\".concat((_this.loading / _this.data.framesCount) * 100, \"%\");\n        };\n        this.opts = opts;\n        if (this.validateOpts()) {\n            this.init();\n        }\n        else {\n            console.error('opts invalid!');\n        }\n    }\n    Scene.prototype.init = function () {\n        var _this = this;\n        this.container = document.getElementById(this.opts.containerId);\n        if (!this.container) {\n            console.error('Container not found!');\n            return;\n        }\n        this.baseUrl = API_URL + this.opts.panelId + '/' + this.opts.productCode;\n        fetch(\"\".concat(this.baseUrl, \"/data\"))\n            .then(function (res) { return res.json(); })\n            .then(function (data) {\n            _this.data = data;\n            _this.events.trigger('load-data', data);\n            _this.setupScene();\n        });\n    };\n    Scene.prototype.setupScene = function () {\n        var _this = this;\n        this.remove();\n        this.sceneElement = document.createElement('div');\n        this.sceneElement.classList.add('threedily-scene');\n        this.container.appendChild(this.sceneElement);\n        this.loading = 0;\n        if (this.data.framesCount < 1)\n            return;\n        this.createLoading();\n        for (var i = 0; i < this.data.framesCount; i++) {\n            var img = document.createElement('img');\n            img.classList.add('threedily-frame');\n            i === this.activeFrame && img.classList.add('threedily-frame-active');\n            this.sceneElement.appendChild(img);\n            this.frameElements.push(img);\n        }\n        var loadFrames = function (i) {\n            if (i === void 0) { i = 0; }\n            _this.frameElements[i].src = _this.buildURL(i);\n            _this.frameElements[i].onload = function () {\n                i < _this.data.framesCount - 1 && loadFrames(i + 1);\n                _this.onLoading();\n                _this.frameElements[i].onload = null;\n            };\n        };\n        loadFrames();\n    };\n    Scene.prototype.createLoading = function () {\n        var progress = document.createElement('div');\n        progress.classList.add('threedily-linear-progress');\n        var bar = document.createElement('div');\n        progress.appendChild(bar);\n        bar.classList.add('threedily-linear-progress-bar');\n        this.sceneElement.appendChild(progress);\n        this.progressbar = progress;\n    };\n    Scene.prototype.validateOpts = function () {\n        return this.opts.panelId && this.opts.containerId && this.opts.productCode;\n    };\n    Scene.prototype.buildURL = function (frame, quality) {\n        if (quality === void 0) { quality = '2k'; }\n        return \"\".concat(this.baseUrl, \"/image?frame=\").concat(frame).concat(this.opts.shadow === true || typeof this.opts.shadow === 'undefined'\n            ? ''\n            : '&shadow=false', \"&size=\").concat(JSON.stringify({\n            width: quality === '1k' ? 1024 : quality === '2k' ? 1920 : 3840,\n        })).concat(this.opts.variants\n            ? '&variants=' + JSON.stringify(this.opts.variants)\n            : '');\n    };\n    Scene.prototype.remove = function () {\n        this.frameElements = [];\n        if (this.sceneElement) {\n            this.sceneElement.remove();\n        }\n    };\n    Scene.prototype.changeVariants = function (variants) {\n        this.opts.variants = variants;\n        this.setupScene();\n    };\n    Scene.prototype.toggleShadow = function () {\n        this.opts.shadow = !this.opts.shadow;\n        this.setupScene();\n    };\n    Scene.prototype.getData = function () {\n        return this.data;\n    };\n    Scene.prototype.on = function () {\n        var _a;\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        (_a = this.events).on.apply(_a, args);\n    };\n    Scene.prototype.off = function () {\n        var _a;\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        (_a = this.events).off.apply(_a, args);\n    };\n    return Scene;\n}());\nexport { Scene };\n","import { Scene } from './scene/index.js';\nfunction Threedily(opts) {\n    var scene = new Scene(opts);\n    return scene;\n}\nexport { Threedily };\n"],"names":["clamp","number","min","max","Math","Controller","element","framesCount","onChangeFrame","onZoom","this","pointerPosition","x","y","pointerIsDown","moved","activeIndex","zoomIsEnable","zoomScale","translate","init","prototype","_this","onpointerdown","e","clientX","clientY","onpointermove","deltaX","abs","index","onclick","getTranslate","concat","onpointerup","onmousemove","ontouchmove","widthDelta","clientWidth","heightDelta","clientHeight","delta","touches","localPosition","offsetLeft","parseInt","window","getComputedStyle","borderWidth","replace","offsetTop","Events","handlers","on","args","_i","arguments","length","push","trigger","_a","_b","h","off","filter","Scene","opts","activeFrame","frameElements","loading","events","zoom","i","classList","remove","add","transform","style","src","buildURL","onLoading","data","controller","sceneElement","setTimeout","progressbar","firstChild","width","validateOpts","console","error","container","document","getElementById","containerId","baseUrl","panelId","productCode","fetch","then","res","json","setupScene","createElement","appendChild","createLoading","img","loadFrames","onload","progress","bar","frame","quality","shadow","JSON","stringify","variants","changeVariants","toggleShadow","getData","apply"],"mappings":"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"}